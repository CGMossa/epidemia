<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a Bayesian epidemiological model with epidemia — epim • epidemia</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Fit a Bayesian epidemiological model with epidemia — epim" />
<meta property="og:description" content="epim is the only model fitting function in epidemia.
It takes a model description, a dataframe, and additional
arguments relating to the fitting algorithm, and translates this
to data that is then passed to a precompiled Stan program which is used to fit the model.
This allows model fitting to begin immediately as opposed to requiring compilation
each time epim is called." />
<meta property="og:image" content="https://imperialcollegelondon.github.io/epidemia/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS_CHTML.js" crossorigin="anonymous"></script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-186908163-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-186908163-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epidemia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/install.html">Install</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/model-introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/model-description.html">Description</a>
    </li>
    <li>
      <a href="../articles/model-implementation.html">Implementation</a>
    </li>
    <li>
      <a href="../articles/model-schematic.html">Schematic</a>
    </li>
    <li>
      <a href="../articles/partial-pooling.html">Partial Pooling</a>
    </li>
    <li>
      <a href="../articles/priors.html">Priors</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/flu.html">A Basic Example</a>
    </li>
    <li>
      <a href="../articles/europe-covid.html">A Multilevel Model</a>
    </li>
    <li>
      <a href="../articles/multiple-obs.html">Multiple Observations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ImperialCollegeLondon/epidemia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a Bayesian epidemiological model with epidemia</h1>
    <small class="dont-index">Source: <a href='https://github.com/ImperialCollegeLondon/epidemia/blob/master/R/epim.R'><code>R/epim.R</code></a></small>
    <div class="hidden name"><code>epim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>epim</code> is the only model fitting function in <span class="pkg">epidemia</span>.
It takes a model description, a dataframe, and additional
arguments relating to the fitting algorithm, and translates this
to data that is then passed to a precompiled <span class="pkg">Stan</span> program which is used to fit the model.
This allows model fitting to begin immediately as opposed to requiring compilation
each time <code>epim</code> is called.</p>
    </div>

    <pre class="usage"><span class='fu'>epim</span>(
  <span class='no'>rt</span>,
  <span class='no'>inf</span>,
  <span class='no'>obs</span>,
  <span class='no'>data</span>,
  <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sampling"</span>, <span class='st'>"meanfield"</span>, <span class='st'>"fullrank"</span>),
  <span class='kw'>group_subset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>prior_PD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>rt</th>
      <td><p>An object of class <code>epirt</code>. This defines
the model for the time-varying reproduction rates. See <code><a href='epirt.html'>epirt</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>inf</th>
      <td><p>An object of class <code>epiinf</code>. This defines
the model for latent infections. See <code><a href='epiinf.html'>epiinf</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>obs</th>
      <td><p>Either an <code>epiobs</code> object, or a list of such objects. Each
element in the list defines a model for the specified observation vector. See <code><a href='epiobs.html'>epiobs</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A dataframe with all data required for fitting the model. This includes all observation variables and covariates specified in the models for the reproduction number and ascertainment rates.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>One of <code>"sampling"</code>, <code>"meanfield"</code> or
<code>"fullrank"</code>. This specifies which <span class="pkg">rstan</span> function to use for
fitting the model. For <code>"sampling"</code> this is <code><a href='https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html'>sampling</a></code>, otherwise
this is <code><a href='https://mc-stan.org/rstan/reference/stanmodel-method-vb.html'>vb</a></code>.</p></td>
    </tr>
    <tr>
      <th>group_subset</th>
      <td><p>If specified, a character vector naming a subset of regions to include in the model.</p></td>
    </tr>
    <tr>
      <th>prior_PD</th>
      <td><p>Same as in <code><a href='https://mc-stan.org/rstanarm/reference/stan_glm.html'>stan_glm</a></code>. If <code>TRUE</code>,
samples all parameters from the joint prior distribution. This is useful for
prior predictive checks. Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to pass to the <span class="pkg">rstan</span> function used to fit the model.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>epimodel</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is similar to the workflow for fitting Bayesian regression models with <span class="pkg">rstanarm</span>.
A key difference, however, is that the models fit by <span class="pkg">epidemia</span> are much more complex,
and are therefore inherently more difficult to specify. <span class="pkg">epidemia</span> aims to simplify this
process by modularizing the model definition into three distinct parts: transmission, infections and observations.
These components of the model are defined with the functions <code><a href='epirt.html'>epirt</a></code>, <code><a href='epiinf.html'>epiinf</a></code> and <code><a href='epiobs.html'>epiobs</a></code>
respectively.</p>
<p><code>epim</code> has arguments
<code>rt</code>, <code>inf</code> and <code>obs</code> which expect a description of the
transmission model, infection model and observational models respectively.
Together, these fully define the joint distribution of data and parameters.
Each of these model components are described in terms of variables that are expected to live in a single dataframe, <code>data</code>.
This dataframe must be compatible with the model components, in the sense that it holds all variables defined in these models.</p>
<p>In addition to taking a model description and a dataframe, <code>epim</code> has various
additional arguments which specify how the model should be fit. If <code>algorithm = "sampling"</code>
then the model will be fit using <span class="pkg">Stan</span>’s adaptive Hamiltonian Monte Carlo sampler.
This is done internally by calling <code><a href='https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html'>sampling</a></code>. If
<code>algorithm = "meanfield"</code> or <code>algorithm = "fullrank"</code>, then
<span class="pkg">Stan</span>’s variational Bayes algorithms are used instead, by calling <code><a href='https://mc-stan.org/rstan/reference/stanmodel-method-vb.html'>vb</a></code>.
Any unnamed arguments in the call to <code>epim</code> are passed directly on to the <span class="pkg">rstan</span> sampling function.
<code>epim</code> returns a fitted model object of class <code>epimodel</code>, which contains posterior samples from the model along with other useful objects.</p>
<p>In general, the adaptive Hamiltonian Monte Carlo sampler should be used for final inference.
Nonetheless, fitting these models using HMC is often computationally demanding, and variational Bayes can often be fruitful for quickly iterating models.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>EpiEstim</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"Flu1918"</span>)

<span class='no'>date</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span>(<span class='st'>"1918-01-01"</span>) + <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='kw'>along.with</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>, <span class='no'>Flu1918</span>$<span class='no'>incidence</span>))
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
 <span class='kw'>city</span> <span class='kw'>=</span> <span class='st'>"Baltimore"</span>,
 <span class='kw'>cases</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>, <span class='no'>Flu1918</span>$<span class='no'>incidence</span>),
 <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>date</span>,
 <span class='kw'>week</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/week.html'>week</a></span>(<span class='no'>date</span>)
)

<span class='no'>rt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='epirt.html'>epirt</a></span>(
 <span class='kw'>formula</span> <span class='kw'>=</span> <span class='fu'>R</span>(<span class='no'>city</span>, <span class='no'>date</span>) ~ <span class='fu'><a href='rw.html'>rw</a></span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='no'>week</span>, <span class='kw'>prior_scale</span> <span class='kw'>=</span> <span class='fl'>0.1</span>),
 <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='kw pkg'>rstanarm</span><span class='kw ns'>::</span><span class='fu'><a href='https://mc-stan.org/rstanarm/reference/priors.html'>normal</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='fl'>2</span>), <span class='fl'>0.2</span>),
 <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>'log'</span>
)

<span class='no'>obs</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='epiobs.html'>epiobs</a></span>(
 <span class='kw'>formula</span> <span class='kw'>=</span> <span class='no'>cases</span> ~ <span class='fl'>1</span>,
 <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='kw pkg'>rstanarm</span><span class='kw ns'>::</span><span class='fu'><a href='https://mc-stan.org/rstanarm/reference/priors.html'>normal</a></span>(<span class='kw'>location</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>0.01</span>),
 <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>,
 <span class='kw'>i2o</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>.25</span>,<span class='fl'>4</span>)
)

<span class='no'>args</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
 <span class='kw'>rt</span> <span class='kw'>=</span> <span class='no'>rt</span>,
 <span class='kw'>inf</span> <span class='kw'>=</span> <span class='fu'><a href='epiinf.html'>epiinf</a></span>(<span class='kw'>gen</span> <span class='kw'>=</span> <span class='no'>Flu1918</span>$<span class='no'>si_distr</span>),
 <span class='kw'>obs</span> <span class='kw'>=</span> <span class='no'>obs</span>,
 <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>data</span>,
 <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='st'>"fullrank"</span>,
 <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1e4</span>,
 <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>
)

<span class='no'>fm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span>(<span class='no'>epim</span>, <span class='no'>args</span>)</div><div class='output co'>#&gt; Chain 1: ------------------------------------------------------------
#&gt; Chain 1: EXPERIMENTAL ALGORITHM:
#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable
#&gt; Chain 1:   or buggy. The interface is subject to change.
#&gt; Chain 1: ------------------------------------------------------------
#&gt; Chain 1: 
#&gt; Chain 1: 
#&gt; Chain 1: Rejecting initial value:
#&gt; Chain 1:   Error evaluating the log probability at the initial value.
#&gt; Chain 1: Exception: neg_binomial_2_lpmf: Location parameter[1] is -7.96211e-06, but must be &gt; 0!  (in 'model_epidemia_base' at line 154)
#&gt; 
#&gt; Chain 1: 
#&gt; Chain 1: Gradient evaluation took 0.000284 seconds
#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.84 seconds.
#&gt; Chain 1: Adjust your expectations accordingly!
#&gt; Chain 1: 
#&gt; Chain 1: 
#&gt; Chain 1: Begin eta adaptation.
#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)
#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)
#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)
#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)
#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)
#&gt; Chain 1: Iteration: 250 / 250 [100%]  (Adaptation)
#&gt; Chain 1: Success! Found best value [eta = 0.1].
#&gt; Chain 1: 
#&gt; Chain 1: Begin stochastic gradient ascent.
#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes 
#&gt; Chain 1:    100        -5860.749             1.000            1.000
#&gt; Chain 1:    200        -4207.575             0.696            1.000
#&gt; Chain 1:    300        -2650.502             0.660            0.587
#&gt; Chain 1:    400        -1441.156             0.705            0.839
#&gt; Chain 1:    500        -1216.215             0.601            0.587
#&gt; Chain 1:    600        -1209.856             0.502            0.587
#&gt; Chain 1:    700        -1127.632             0.440            0.393
#&gt; Chain 1:    800         -910.625             0.415            0.393
#&gt; Chain 1:    900         -974.331             0.376            0.238
#&gt; Chain 1:   1000         -813.998             0.358            0.238
#&gt; Chain 1:   1100         -906.963             0.269            0.197
#&gt; Chain 1:   1200         -811.175             0.241            0.185
#&gt; Chain 1:   1300         -704.472             0.197            0.151
#&gt; Chain 1:   1400         -912.199             0.136            0.151
#&gt; Chain 1:   1500         -638.591             0.161            0.151
#&gt; Chain 1:   1600         -689.650             0.168            0.151
#&gt; Chain 1:   1700         -624.428             0.171            0.151
#&gt; Chain 1:   1800         -670.520             0.154            0.118
#&gt; Chain 1:   1900         -677.843             0.148            0.118
#&gt; Chain 1:   2000         -626.944             0.137            0.104
#&gt; Chain 1:   2100         -546.190             0.141            0.118
#&gt; Chain 1:   2200         -548.548             0.130            0.104
#&gt; Chain 1:   2300         -586.539             0.121            0.081
#&gt; Chain 1:   2400         -569.394             0.101            0.074
#&gt; Chain 1:   2500         -586.787             0.062            0.069
#&gt; Chain 1:   2600         -578.063             0.056            0.065
#&gt; Chain 1:   2700         -566.092             0.047            0.030
#&gt; Chain 1:   2800         -553.299             0.043            0.030
#&gt; Chain 1:   2900         -587.195             0.047            0.030
#&gt; Chain 1:   3000         -536.875             0.049            0.030
#&gt; Chain 1:   3100         -603.497             0.045            0.030
#&gt; Chain 1:   3200         -550.315             0.054            0.058
#&gt; Chain 1:   3300         -538.754             0.050            0.030
#&gt; Chain 1:   3400         -552.282             0.049            0.030
#&gt; Chain 1:   3500         -530.377             0.051            0.041
#&gt; Chain 1:   3600         -518.013             0.051            0.041
#&gt; Chain 1:   3700         -519.449             0.050            0.041
#&gt; Chain 1:   3800         -618.422             0.063            0.058
#&gt; Chain 1:   3900         -533.789             0.073            0.094
#&gt; Chain 1:   4000         -486.536             0.074            0.097
#&gt; Chain 1:   4100         -526.909             0.070            0.077
#&gt; Chain 1:   4200         -550.408             0.065            0.043
#&gt; Chain 1:   4300         -517.502             0.069            0.064
#&gt; Chain 1:   4400         -488.755             0.073            0.064
#&gt; Chain 1:   4500         -580.766             0.084            0.077
#&gt; Chain 1:   4600         -503.138             0.097            0.097
#&gt; Chain 1:   4700         -535.972             0.103            0.097
#&gt; Chain 1:   4800         -507.943             0.093            0.077
#&gt; Chain 1:   4900         -485.150             0.081            0.064
#&gt; Chain 1:   5000         -493.939             0.074            0.061
#&gt; Chain 1:   5100         -469.627             0.071            0.059
#&gt; Chain 1:   5200         -577.918             0.086            0.061
#&gt; Chain 1:   5300         -469.447             0.102            0.061
#&gt; Chain 1:   5400         -468.974             0.097            0.061
#&gt; Chain 1:   5500         -500.700             0.087            0.061
#&gt; Chain 1:   5600         -493.748             0.073            0.055
#&gt; Chain 1:   5700         -492.404             0.067            0.052
#&gt; Chain 1:   5800         -488.857             0.062            0.047
#&gt; Chain 1:   5900         -471.381             0.061            0.037
#&gt; Chain 1:   6000         -469.551             0.060            0.037
#&gt; Chain 1:   6100         -442.325             0.061            0.037
#&gt; Chain 1:   6200         -477.826             0.050            0.037
#&gt; Chain 1:   6300         -485.489             0.028            0.016
#&gt; Chain 1:   6400         -478.790             0.029            0.016
#&gt; Chain 1:   6500         -461.772             0.027            0.016
#&gt; Chain 1:   6600         -472.519             0.028            0.023
#&gt; Chain 1:   6700         -455.661             0.031            0.037
#&gt; Chain 1:   6800         -491.113             0.038            0.037
#&gt; Chain 1:   6900         -441.741             0.045            0.037
#&gt; Chain 1:   7000         -447.105             0.046            0.037
#&gt; Chain 1:   7100         -458.586             0.042            0.037
#&gt; Chain 1:   7200         -454.954             0.036            0.025
#&gt; Chain 1:   7300         -457.807             0.035            0.025
#&gt; Chain 1:   7400         -469.904             0.036            0.026
#&gt; Chain 1:   7500         -436.675             0.040            0.026
#&gt; Chain 1:   7600         -474.067             0.045            0.037
#&gt; Chain 1:   7700         -440.314             0.049            0.072
#&gt; Chain 1:   7800         -470.366             0.048            0.064
#&gt; Chain 1:   7900         -458.155             0.040            0.027
#&gt; Chain 1:   8000         -440.942             0.043            0.039
#&gt; Chain 1:   8100         -467.038             0.046            0.056
#&gt; Chain 1:   8200         -451.515             0.048            0.056
#&gt; Chain 1:   8300         -434.668             0.052            0.056
#&gt; Chain 1:   8400         -447.735             0.052            0.056
#&gt; Chain 1:   8500         -435.657             0.047            0.039
#&gt; Chain 1:   8600         -450.502             0.043            0.039
#&gt; Chain 1:   8700         -438.568             0.038            0.034
#&gt; Chain 1:   8800         -467.144             0.037            0.034
#&gt; Chain 1:   8900         -482.755             0.038            0.034
#&gt; Chain 1:   9000         -425.383             0.047            0.034
#&gt; Chain 1:   9100         -447.279             0.047            0.034
#&gt; Chain 1:   9200         -426.487             0.048            0.039
#&gt; Chain 1:   9300         -436.099             0.047            0.033
#&gt; Chain 1:   9400         -436.387             0.044            0.033
#&gt; Chain 1:   9500         -469.269             0.048            0.049
#&gt; Chain 1:   9600         -441.920             0.051            0.049
#&gt; Chain 1:   9700         -440.928             0.048            0.049
#&gt; Chain 1:   9800         -460.802             0.046            0.049
#&gt; Chain 1:   9900         -454.914             0.045            0.049
#&gt; Chain 1:   10000         -439.420             0.035            0.043
#&gt; Chain 1: Informational Message: The maximum number of iterations is reached! The algorithm may not have converged.
#&gt; Chain 1: This variational approximation is not guaranteed to be meaningful.
#&gt; Chain 1: 
#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... 
#&gt; Chain 1: COMPLETED.</div><div class='output co'>#&gt; <span class='warning'>Warning: Pareto k diagnostic value is 2.81. Resampling is disabled. Decreasing tol_rel_obj may help if variational algorithm has terminated prematurely. Otherwise consider using sampling instead.</span></div><div class='input'>
# }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James Scott, Axel Gandy, Swapnil Mishra, Juliette Unwin, Seth Flaxman, Samir Bhatt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


