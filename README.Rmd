
---
title: "epidemia"
output: 
  github_document:
    fig_width: 10
    fig_height: 6
bibliography: inst/REFERENCES.bib
vignette: >
  %\VignetteIndexEntry{README}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

*epidemia* is an R package allowing flexible 
specification and fitting of Bayesian epidemiological models in the style of 
@Flaxman2020. The package leverages R's formula interface to paramaterize the time-varying reproduction rate as a function of covariates. Multiple populations can be modelled simultaneously using hierarchical models. The design of the package has been inspired by, and has borrowed from, the rstanarm package [@rstanarm]. epidemia uses rstan [@rstan] as the backend for fitting models.

This is a beta release of the package. It will be regularly updated with additional features, and more extensive testing. Any feedback is greatly appreciated - in particular if you find bugs, find the documentation unclear, or have feature requests, please report them [here](https://github.com/ImperialCollegeLondon/epidemia/issues).

## Getting Started

Please read the vignettes 

Please see [here](/vignettes/introduction.md) for a demonstration on how to use the package. 

# Example Usage

```{r exampleUsage}
library(epidemia)
library(xfun)
options(mc.cores=parallel::detectCores())

data(EuropeCovid)
# Collect args for epim
args <- EuropeCovid
args$algorithm <- "sampling"
args$group_subset <- c("Germany", "United_Kingdom")
args$sampling_args <- list(iter=1e3,control=list(adapt_delta=0.95,max_treedepth=15),seed=12345)
args$formula <- R(country, date) ~ schools_universities + self_isolating_if_ill +
  public_events + lockdown + social_distancing_encouraged
args$prior <- shifted_gamma(shape = 1/6, scale = 1, shift = -log(1.05)/6)
fit <- xfun::cache_rds({do.call("epim", args)}, hash=args)
```

```{r examplePlots}
# Inspect Rt
plot_rt(fit, group = "United_Kingdom", levels = c(25,50,75,95))
# And deaths
plot_obs(fit, type = "deaths", group = "United_Kingdom", levels = c(25,50,75,95))
```

# References